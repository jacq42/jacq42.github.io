---
layout: post
title:  Domain Driven Design
tags: [ DDD ]
author: jacq42
excerpt_separator: <!--more-->
#color: rgb(0, 100,100)
---

Was ist Domain Driven Design? Welche Tools enthält die Werkzeugbox?

<!--more-->

Domain Driven Design (DDD) ist kein Framework oder Tool sondern ein Potpouri. Es gibt eine Unterscheidung in taktisches und strategisches Design.\
Im **taktischen Design** sind die Buildingblocks enthalten (Aggregate, Entity, ValueObject etc.). Hier bekommt der Entwickler konkrete Dinge für die Umsetzung an die Hand.\
Im **strategischen Design** wird versucht, mit dem gesamten Team (Developer + Domänenexperten) den/die Bounded Contexte, die Ubiquitous Language und die Context Map(s) zu erstellen. Anhand dessen sollte die Software geschnitten werden, damit die Teams möglichst unabhängig voneinander agieren können. Der Schnitt der Software erfolgt fachlich und nicht technisch.

## Definition

| Domain, Domainmodel

## Context matters

Ein Begriff in Context A hat eine andere Bedeutung als der gleiche Begriff in Context B.

![Context matters](/assets/img/jk/ContextMatters.png){:width='75%'}

**Beispiel: Kunde in einem Onlineshop**

Im __Kontext Bestellung__ sind Eigenschaften wie z.B. die Adresse wichtig. Im __Kontext Abrechnung__ sind Eigenschaften wie Zahlungsmöglichkeiten, Zahlungsmoral etc. wichtig. Ein globales Modell vom Kunden macht keinen Sinn, da nicht in jedem Kontext die Informationen benötigt werden und evtl. auch nicht bekannt sein sollen.

## Bounded Context

* Semantische Einheit
* Grenze, innerhalb deren ein Modell seine Gültigkeit hat
* Ubiquitous Language

* Problem Space -> ContextMap
* Solution Space

## Context Mapping

* = Landkarte der Kontexte
* Kontextübersicht skizzieren: Wie hängen die einzelnen Kontexte zusammen? Was sind die Abhängigkeiten?
* Auf Whiteboard oder Papier erstellen zusammen mit dem gesamten Team (Entwickler und Domänenexperten)
* Namen der Kontexte finden!
* Tool zum digitalen Erstellen: [Context Mapper](https://contextmapper.org/) -> noch nicht getestet

### Patterns

![ContextMap Examples](/assets/img/jk/Examples_ContextMap.svg)

* Big Ball Of Mud
* In-Beetween Patterns:
	* Partnership (P)
	* Shared Kernel (SK)
		* Modell/Code/DB wird geteilt
		* kann nur geändert werden, wenn beide Teams zustimmen
	* Published Language (PL)
		* Austausch des Modells über eine definierte Spracht (WSDL)
		* wird oft zusammen mit dem Open Host Service verwendet
	* Separate Ways (SW)
		* es bestehen keine Beziehungen zwischen den Kontexten
		* in der Übersicht nur markieren, wenn keine Beziehungen bestehen sollen (sonst wird es zu unübersichtlich)
* Upstream Patterns:
	* Open Host Service (OHS)
		* Definition eines Protokolls, um anderen Systemen den Zugriff zu ermöglichen (REST, Soap)
	* Event Publisher (EP)
		* Publizierung eines Events (z.B. über Kafka)
    	* wer das Event nutzt, ist nicht bekannt
* Downstream Patterns:
	* Customer/Supplier (CS)
		* Downstream kann mitbestimmen, ob eine Änderung gemacht werden soll
		* Beispiel: APIs innerhalb einer Firma
	* Conformist (CF)
		* Downstream kann nicht mitbestimmen und muss auf Änderungen reagieren
		* Beispiel: öffentliche APIs wie z.B. von Facebook
	* Anticorruption Layer (ACL)
		* Tanslationlayer, um die Abhängigkeit zum Upstream Team zu minimieren
		* übersetzt das Modell des Upstream Teams in das eigene Modell
		* kann beidseitig sein
    	
### Context Mapper

Tool zum Erstellen von ContextMaps. Es gibt ein [Eclipse Plugin](https://marketplace.eclipse.org/content/context-mapper).\
Möchte man die Map grafisch erstellen lassen, muss [GraphViz](https://graphviz.org/) installiert sein.

1. Neues Projekt erstellen oder vorhandenes nutzen
2. Configure > Convert to Xtext Project
3. *.cml Datei erstellen
4. Im Kontextmenü: Context Mapper > Generate Graphical Context Map
5. ContextMap wird unter **src-gen** erstellt

Auflistung der einzelnen Beziehungen ab [hier](https://contextmapper.org/docs/language-reference/)

## Literatur

* [Blue Book von Eric Evans](https://www.domainlanguage.com/ddd/blue-book/)
* [DDD Referenz DE](https://ddd-referenz.de/){:target='blank'}
* [DDD Referenz EN](https://www.domainlanguage.com/ddd/reference/){:target='blank'}